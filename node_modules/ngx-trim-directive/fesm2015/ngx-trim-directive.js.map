{"version":3,"file":"ngx-trim-directive.js","sources":["ng://ngx-trim-directive/ngx-trim.directive.ts","ng://ngx-trim-directive/ngx-trim-directive.module.ts"],"sourcesContent":["import {\n  Directive,\n  ElementRef,\n  HostListener,\n  Input,\n  OnDestroy,\n  OnInit,\n  Optional,\n} from '@angular/core';\nimport {\n  ControlValueAccessor,\n  NgControl,\n} from '@angular/forms';\n\n@Directive({\n  selector: 'input[trim],textarea[trim]',\n})\nexport class NgxTrimDirective implements OnInit, OnDestroy {\n\n  private _trim: '' | 'blur' | false;\n  @Input('trim')\n  public set trim (trimOption: '' | 'blur' | false) {\n    if (trimOption !== '' && trimOption !== 'blur' && trimOption !== false) {\n      console.warn(`Note: The value ${JSON.stringify(trimOption)} is not assignable to the trim attribute.\n        Only blank string (\"\"), \"blur\" or false is allowed.`);\n\n      this._trim = false;\n      return;\n    }\n\n    this._trim = trimOption;\n\n    const elem = this.elementRef.nativeElement;\n    const eleValue = elem.value;\n    if (trimOption !== false && eleValue !== eleValue.trim()) {\n      // initially trim the value if needed\n      NgxTrimDirective.dispatchEvent(elem, 'blur');\n    }\n  }\n\n  public get trim () {\n    return this._trim;\n  }\n\n  @Input() trimOnWriteValue = true;\n\n  private _valueAccessor: ControlValueAccessor;\n  private _writeValue: (value) => void;\n\n  constructor (\n    private elementRef: ElementRef,\n    @Optional() private ngControl: NgControl,\n  ) {\n  }\n\n  private static getCaret (el) {\n\n    return {\n      start: el.selectionStart,\n      end: el.selectionEnd,\n    };\n\n  }\n\n  private static setCaret (el, start, end) {\n\n    el.selectionStart = start;\n    el.selectionEnd = end;\n\n    el.focus();\n\n  }\n\n  private static dispatchEvent (el, eventType) {\n\n    const event = document.createEvent('Event');\n    event.initEvent(eventType, false, false);\n    el.dispatchEvent(event);\n\n  }\n\n  private static trimValue (el, value) {\n\n    el.value = value.trim();\n\n    NgxTrimDirective.dispatchEvent(el, 'input');\n\n  }\n\n  ngOnInit (): void {\n\n    if (!this.ngControl) {\n\n      console.warn('Note: The trim directive should be used with one of ngModel, formControl or formControlName directives.');\n\n      return;\n\n    }\n\n    this._valueAccessor = this.ngControl.valueAccessor;\n\n    this._writeValue = this._valueAccessor.writeValue;\n    this._valueAccessor.writeValue = (value) => {\n      const _value =\n        this.trim === false || !value || 'function' !== typeof value.trim || !this.trimOnWriteValue\n          ? value\n          : value.trim();\n\n      if (this._writeValue) {\n        this._writeValue.call(this._valueAccessor, _value);\n      }\n\n      if (value !== _value) {\n        if (this._valueAccessor['onChange']) {\n          this._valueAccessor['onChange'](_value);\n        }\n\n        if (this._valueAccessor['onTouched']) {\n          this._valueAccessor['onTouched']();\n        }\n      }\n\n    };\n\n  }\n\n  ngOnDestroy (): void {\n\n    if (this._valueAccessor && this._writeValue) {\n\n      this._valueAccessor.writeValue = this._writeValue;\n\n    }\n\n  }\n\n  @HostListener('blur', [\n    '$event.target',\n    '$event.target.value',\n  ])\n  onBlur (el: any, value: string): void {\n\n    if (this.trim === false) {\n\n      return;\n\n    }\n\n    if ((this.trim === '' || 'blur' === this.trim) && 'function' === typeof value.trim && value.trim() !== value) {\n\n      NgxTrimDirective.trimValue(el, value);\n      NgxTrimDirective.dispatchEvent(el, 'blur'); // in case updateOn is set to blur\n\n    }\n\n  }\n\n  @HostListener('input', [\n    '$event.target',\n    '$event.target.value',\n  ])\n  onInput (el: any, value: string): void {\n\n    if (this.trim === false) {\n\n      return;\n\n    }\n\n    if (this.trim === '' && 'function' === typeof value.trim && value.trim() !== value) {\n\n      let { start, end } = NgxTrimDirective.getCaret(el);\n\n      if (value[0] === ' ' && start === 1 && end === 1) {\n\n        start = 0;\n        end = 0;\n\n      }\n\n      NgxTrimDirective.trimValue(el, value);\n\n      NgxTrimDirective.setCaret(el, start, end);\n\n    }\n\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { NgxTrimDirective } from './ngx-trim.directive';\n\n@NgModule({\n  imports: [],\n  declarations: [NgxTrimDirective],\n  exports: [NgxTrimDirective],\n})\nexport class NgxTrimDirectiveModule {\n}\n"],"names":[],"mappings":"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"}